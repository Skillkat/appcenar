<div class="container">
  <h2>Seleccionar Dirección para {{commerce.name}}</h2>
  {{#if errors}}
    <div class="alert alert-danger">
      {{#each errors}}
        <p>{{msg}}</p>
      {{/each}}
    </div>
  {{/if}}
  <h3>Carrito</h3>
  {{#if cart.length}}
    <ul>
      {{#each cart}}
        <li>{{name}} - Cantidad: {{quantity}} - RD$ {{price}} x {{quantity}} = RD$ {{multiply price quantity}}</li>
      {{/each}}
    </ul>
    <p>Subtotal: RD$ {{subtotal}}</p>
    <p>ITBIS (18%): RD$ {{itbisAmount}}</p>
    <p>Total: RD$ {{total}}</p>
  {{else}}
    <p>El carrito está vacío.</p>
  {{/if}}
  <h3>Seleccionar Dirección</h3>
  {{#if addresses.length}}
    <form action="/client/select-address/{{commerce.id}}" method="POST">
      <div class="mb-3">
        <label for="addressId" class="form-label">Dirección</label>
        <select class="form-select" id="addressId" name="addressId" required>
          <option value="">Seleccione una dirección</option>
          {{#each addresses}}
            <option value="{{id}}">{{name}} - {{description}}</option>
          {{/each}}
        </select>
      </div>
      <button type="submit" class="btn btn-primary">Confirmar Pedido</button>
      <a href="/client/catalog/{{commerce.id}}" class="btn btn-secondary">Volver al Catálogo</a>
    </form>
  {{else}}
    <p>No tienes direcciones registradas. <a href="/client/address/new">Añade una dirección</a>.</p>
  {{/if}}
</div>