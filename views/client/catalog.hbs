<div class="container">
  <h2>Catálogo de {{commerce.name}}</h2>
  {{#if cartMessage}}
    <div class="alert alert-success">{{cartMessage}}</div>
  {{/if}}
  {{#each categories}}
    <div class="category">
      <h3>{{name}}</h3>
      {{#if Products.length}}
        <div class="products">
          {{#each Products}}
            <div class="product">
              {{#if photo}}
                <img src="/Uploads/{{photo}}" alt="{{name}}" style="width: 100px; height: 100px; object-fit: cover;">
              {{else}}
                <p>Sin imagen</p>
              {{/if}}
              <h4>{{name}}</h4>
              <p>{{description}}</p>
              <p>RD$ {{price}}</p>
              <form action="/client/catalog/{{../../commerce.id}}/add-to-cart" method="POST">
                <input type="hidden" name="productId" value="{{id}}">
                <div class="mb-3">
                  <label for="quantity-{{id}}" class="form-label">Cantidad</label>
                  <input type="number" class="form-control" id="quantity-{{id}}" name="quantity" value="1" min="1" required style="width: 100px;">
                </div>
                <button type="submit" class="btn btn-primary">Añadir al Carrito</button>
              </form>
            </div>
          {{/each}}
        </div>
      {{else}}
        <p>No hay productos en esta categoría.</p>
      {{/if}}
    </div>
  {{else}}
    <p>No hay categorías disponibles.</p>
  {{/each}}
  {{#if cart.length}}
    <div class="cart">
      <h3>Carrito</h3>
      <ul>
        {{#each cart}}
          <li>{{name}} - Cantidad: {{quantity}} - RD$ {{price}} x {{quantity}} = RD$ {{multiply price quantity}}</li>
          <form action="/client/catalog/{{../commerce.id}}/remove-from-cart" method="POST" style="display:inline;">
            <input type="hidden" name="productId" value="{{productId}}">
            <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
          </form>
        {{/each}}
      </ul>
      <a href="/client/select-address/{{commerce.id}}" class="btn btn-success">Confirmar Pedido</a>
    </div>
  {{/if}}
</div>